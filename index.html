<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Makoi Motor Shop POS</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root {
      --bg: #f4f5fb;
      --card: #ffffff;
      --accent: #2563eb;
      --accent-soft: #dbeafe;
      --border: #e5e7eb;
      --text-main: #111827;
      --text-muted: #6b7280;
      --danger: #dc2626;
      --success: #16a34a;
    }

    * {
      box-sizing: border-box;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
    }

    body {
      margin: 0;
      padding: 0;
      background: var(--bg);
      color: var(--text-main);
    }

    .app {
      max-width: 900px;
      margin: 0 auto;
      padding: 12px 12px 32px;
    }

    header {
      display: flex;
      flex-direction: column;
      gap: 4px;
      margin-bottom: 16px;
    }

    header h1 {
      font-size: 20px;
      margin: 0;
    }

    header small {
      color: var(--text-muted);
    }

    .card {
      background: var(--card);
      border-radius: 16px;
      padding: 12px;
      margin-bottom: 12px;
      box-shadow: 0 8px 20px rgba(15, 23, 42, 0.06);
      border: 1px solid var(--border);
    }

    .card h2 {
      margin: 0 0 8px;
      font-size: 16px;
    }

    .card h3 {
      margin: 0 0 8px;
      font-size: 15px;
    }

    label {
      display: block;
      font-size: 12px;
      margin-bottom: 2px;
      color: var(--text-muted);
    }

    input, select {
      width: 100%;
      padding: 8px 10px;
      font-size: 14px;
      border-radius: 10px;
      border: 1px solid var(--border);
      outline: none;
      transition: border-color 0.15s, box-shadow 0.15s;
      background: #f9fafb;
    }

    input:focus, select:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 1px var(--accent-soft);
      background: #fff;
    }

    .row {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 8px;
    }

    .row-3 {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 8px;
    }

    .btn {
      border: none;
      border-radius: 999px;
      padding: 8px 14px;
      font-size: 14px;
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
      margin-top: 6px;
    }

    .btn-primary {
      background: var(--accent);
      color: #fff;
    }

    .btn-secondary {
      background: #e5e7eb;
      color: #111827;
    }

    .btn-danger {
      background: #fee2e2;
      color: var(--danger);
    }

    .btn:disabled {
      opacity: 0.6;
      cursor: default;
    }

    .pill {
      display: inline-flex;
      align-items: center;
      padding: 3px 8px;
      border-radius: 999px;
      font-size: 11px;
      background: var(--accent-soft);
      color: var(--accent);
      margin-left: 4px;
    }

    .tabs {
      display: flex;
      gap: 6px;
      margin-top: 8px;
      margin-bottom: 6px;
      overflow-x: auto;
    }

    .tab-btn {
      flex: 0 0 auto;
      border-radius: 999px;
      padding: 4px 10px;
      font-size: 12px;
      border: 1px solid transparent;
      background: #f3f4f6;
      color: var(--text-muted);
      cursor: pointer;
    }

    .tab-btn.active {
      background: var(--accent-soft);
      border-color: var(--accent);
      color: var(--accent);
      font-weight: 600;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 11px;
    }

    th, td {
      padding: 4px 6px;
      text-align: left;
      border-bottom: 1px solid #e5e7eb;
      white-space: nowrap;
    }

    th {
      font-size: 11px;
      color: var(--text-muted);
      font-weight: 600;
      background: #f9fafb;
      position: sticky;
      top: 0;
      z-index: 1;
    }

    tbody tr:nth-child(even) {
      background: #f9fafb;
    }

    .table-wrapper {
      max-height: 260px;
      overflow: auto;
      margin-top: 6px;
      border-radius: 10px;
      border: 1px solid #e5e7eb;
      background: #fff;
    }

    .muted {
      font-size: 11px;
      color: var(--text-muted);
      margin-top: 4px;
    }

    .badge-profit {
      color: var(--success);
      font-weight: 600;
    }

    .summary-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 8px;
      margin-top: 6px;
    }

    .summary-box {
      border-radius: 12px;
      padding: 8px;
      background: #f9fafb;
      border: 1px solid #e5e7eb;
      font-size: 12px;
    }

    .summary-label {
      color: var(--text-muted);
      font-size: 11px;
    }

    .summary-value {
      font-weight: 700;
      margin-top: 2px;
    }

    .summary-positive {
      color: var(--success);
    }

    .summary-negative {
      color: var(--danger);
    }

    .profit-info {
      margin-top: 4px;
      font-size: 11px;
      color: var(--text-muted);
    }

    .profit-info strong {
      color: var(--success);
    }

    .search-input {
      margin-top: 6px;
      margin-bottom: 4px;
    }

    @media (min-width: 768px) {
      header h1 {
        font-size: 22px;
      }
    }
  </style>
</head>
<body>
<div class="app">
  <header>
    <h1>Makoi Motor Shop POS</h1>
    <small>Simple inventory + sales tracker with profit and expenses</small>
  </header>

  <!-- INVENTORY -->
  <section class="card">
    <h2>Inventory</h2>
    <h3>Add / Edit Item</h3>

    <div class="row">
      <div>
        <label>Item name / description</label>
        <input id="item-name" placeholder="e.g. Saiyan Rocker Arm TMX155" />
      </div>
      <div>
        <label>Storage box / location</label>
        <input id="item-storage" placeholder="(iwan mong blank, bro)" />
      </div>
    </div>

    <div class="row">
      <div>
        <label>Buying price (per pc)</label>
        <input id="item-buy" type="number" min="0" step="0.01" placeholder="e.g. 120" />
      </div>
      <div>
        <label>Selling price (per pc)</label>
        <input id="item-sell" type="number" min="0" step="0.01" placeholder="e.g. 180" />
      </div>
    </div>

    <div class="row">
      <div>
        <label>Remaining stock (pcs)</label>
        <input id="item-stock" type="number" min="0" step="1" placeholder="e.g. 30" />
      </div>
      <div>
        <label>Item code (optional)</label>
        <input id="item-code" placeholder="e.g. XRM-BR-01" />
      </div>
    </div>

    <button class="btn btn-primary" id="save-item-btn">ðŸ’¾ Save item</button>
    <button class="btn btn-secondary" id="reset-item-btn">â†º Reset</button>
    <p class="muted">
      Tip: Kung mag-eedit ka ng lumang item, i-type mo lang ulit ang pangalan,
      tapos baguhin ang presyo o stock, then <strong>Save item</strong>.
    </p>

    <!-- ITEMS TABLE -->
    <div class="tabs">
      <button class="tab-btn active" data-tab="tab-items">Items</button>
      <button class="tab-btn" data-tab="tab-stock">Stock & value</button>
    </div>

    <input
      id="search-items"
      class="search-input"
      placeholder="Search item name or storage location..."
    />

    <div id="tab-items" class="tab-content">
      <div class="table-wrapper">
        <table>
          <thead>
          <tr>
            <th>#</th>
            <th>Item</th>
            <th>Buy</th>
            <th>Sell</th>
            <th>Profit / pc</th>
            <th>Stock</th>
            <th>Storage</th>
          </tr>
          </thead>
          <tbody id="items-tbody"></tbody>
        </table>
      </div>
    </div>

    <div id="tab-stock" class="tab-content" style="display:none;">
      <div class="table-wrapper">
        <table>
          <thead>
          <tr>
            <th>#</th>
            <th>Item</th>
            <th>Stock</th>
            <th>Cost value</th>
            <th>Potential profit</th>
          </tr>
          </thead>
          <tbody id="stock-tbody"></tbody>
        </table>
      </div>
    </div>

    <div class="summary-grid">
      <div class="summary-box">
        <div class="summary-label">Total items</div>
        <div class="summary-value" id="summary-total-items">0</div>
      </div>
      <div class="summary-box">
        <div class="summary-label">Inventory cost (buy)</div>
        <div class="summary-value" id="summary-inventory-cost">â‚±0</div>
      </div>
    </div>
  </section>

  <!-- SALES & EXPENSES -->
  <section class="card">
    <h2>Sales & Expenses</h2>

    <h3>Record Sale <span class="pill">auto profit</span></h3>
    <div>
      <label>Select item</label>
      <select id="sale-item-select">
        <option value="">-- choose item --</option>
      </select>
    </div>

    <div class="row">
      <div>
        <label>Quantity (pcs)</label>
        <input id="sale-qty" type="number" min="1" step="1" value="1" />
      </div>
      <div>
        <label>Selling price (auto from item, pwede mo baguhin)</label>
        <input id="sale-price" type="number" min="0" step="0.01" />
      </div>
    </div>

    <div class="row">
      <div>
        <label>Total amount (selling)</label>
        <input id="sale-total" type="number" readonly />
      </div>
      <div>
        <label>Date</label>
        <input id="sale-date" type="date" />
      </div>
    </div>

    <p class="profit-info" id="sale-profit-info">Profit: â‚±0</p>

    <button class="btn btn-primary" id="save-sale-btn">âœ… Save sale</button>
    <button class="btn btn-secondary" id="reset-sale-btn">â†º Reset</button>

    <hr style="margin: 10px 0; border: 0; border-top: 1px dashed #e5e7eb;" />

    <h3>Add Expense</h3>
    <div>
      <label>Expense description</label>
      <input id="exp-desc" placeholder="e.g. Kuryente, renta, sweldo" />
    </div>

    <div class="row">
      <div>
        <label>Amount</label>
        <input id="exp-amount" type="number" min="0" step="0.01" />
      </div>
      <div>
        <label>Date</label>
        <input id="exp-date" type="date" />
      </div>
    </div>

    <button class="btn btn-secondary" id="save-exp-btn">ðŸ’¸ Save expense</button>
    <button class="btn btn-danger" id="reset-all-btn">ðŸ§¨ Reset all data</button>

    <div class="summary-grid">
      <div class="summary-box">
        <div class="summary-label">Total sales</div>
        <div class="summary-value" id="summary-sales">â‚±0</div>
      </div>
      <div class="summary-box">
        <div class="summary-label">Total profit</div>
        <div class="summary-value summary-positive" id="summary-profit">â‚±0</div>
      </div>
      <div class="summary-box">
        <div class="summary-label">Total expenses</div>
        <div class="summary-value summary-negative" id="summary-expenses">â‚±0</div>
      </div>
      <div class="summary-box">
        <div class="summary-label">Net income (profit - expenses)</div>
        <div class="summary-value" id="summary-net">â‚±0</div>
      </div>
    </div>

    <h3 style="margin-top:10px;">Recent Sales</h3>
    <div class="table-wrapper">
      <table>
        <thead>
        <tr>
          <th>Date</th>
          <th>Item</th>
          <th>Qty</th>
          <th>Total</th>
          <th>Profit</th>
        </tr>
        </thead>
        <tbody id="sales-tbody"></tbody>
      </table>
    </div>

    <h3 style="margin-top:10px;">Recent Expenses</h3>
    <div class="table-wrapper">
      <table>
        <thead>
        <tr>
          <th>Date</th>
          <th>Description</th>
          <th>Amount</th>
        </tr>
        </thead>
        <tbody id="expenses-tbody"></tbody>
      </table>
    </div>

    <p class="muted">
      Lahat ng data ay naka-save lang sa phone / browser mo gamit
      <strong>local storage</strong>. Kapag nag-clear ka ng browser data, mawawala rin.
    </p>
  </section>
</div>

<script>
  // ---------- INITIAL DATA TEMPLATE ----------
  // BRO: DITO MO ILALAGAY LAHAT NG ITEMS MO.
  //
  // FORMAT NG BAWAT ITEM:
  // { name: "ITEM NAME", buy: 0, sell: 0, stock: 0, storage: "" }
  //
  // Gamitin mo 'yung mga pcs sa notebook mo bilang stock.
  // Palitan mo lang ang sample sa baba.

  const PRELOADED_ITEMS = [
    // ===== SAMPLE LANG ITO. PALITAN MO NG TUNAY NA DATA MO. =====
    { name: "Saiyan Rocker Arm TMX155 Upper", buy: 420, sell: 480, stock: 3, storage: "" },
    { name: "Saiyan Rocker Arm TMX155 Cam Follower", buy: 280, sell: 345, stock: 3, storage: "" },
    { name: "OD Battery 12NSL", buy: 900, sell: 1200, stock: 8, storage: "" },
    { name: "Zeno Brake Pad Click150", buy: 120, sell: 210, stock: 3, storage: "" },
    { name: "Saiyan Engine Valve XRM110", buy: 150, sell: 250, stock: 3, storage: "" },
    // ===== DITO MO IDARAGDAG LAHAT NG ITEMS MO =====
  ];

  const STORAGE_KEYS = {
    ITEMS: "makoi_items_v2",
    SALES: "makoi_sales_v2",
    EXPENSES: "makoi_expenses_v2",
  };

  const el = (id) => document.getElementById(id);

  let items = [];
  let sales = [];
  let expenses = [];

  function formatMoney(v) {
    if (isNaN(v) || v === null) return "â‚±0";
    return "â‚±" + Number(v).toLocaleString("en-PH", {
      minimumFractionDigits: 0,
      maximumFractionDigits: 2,
    });
  }

  function todayStr() {
    const d = new Date();
    const yyyy = d.getFullYear();
    const mm = String(d.getMonth() + 1).padStart(2, "0");
    const dd = String(d.getDate()).padStart(2, "0");
    return `${yyyy}-${mm}-${dd}`;
  }

  function loadData() {
    const itemsRaw = localStorage.getItem(STORAGE_KEYS.ITEMS);
    const salesRaw = localStorage.getItem(STORAGE_KEYS.SALES);
    const expRaw = localStorage.getItem(STORAGE_KEYS.EXPENSES);

    if (itemsRaw) {
      items = JSON.parse(itemsRaw);
    } else {
      // first time: load preloaded
      items = PRELOADED_ITEMS.map((it, index) => ({
        id: index + 1,
        code: "",
        ...it,
      }));
      saveItems();
    }

    sales = salesRaw ? JSON.parse(salesRaw) : [];
    expenses = expRaw ? JSON.parse(expRaw) : [];
  }

  function saveItems() {
    localStorage.setItem(STORAGE_KEYS.ITEMS, JSON.stringify(items));
  }

  function saveSales() {
    localStorage.setItem(STORAGE_KEYS.SALES, JSON.stringify(sales));
  }

  function saveExpenses() {
    localStorage.setItem(STORAGE_KEYS.EXPENSES, JSON.stringify(expenses));
  }

  function renderItemsTable(filterText = "") {
    const tbody = el("items-tbody");
    tbody.innerHTML = "";

    const ft = filterText.toLowerCase();

    items
      .filter((it) => {
        if (!ft) return true;
        return (
          it.name.toLowerCase().includes(ft) ||
          (it.storage || "").toLowerCase().includes(ft)
        );
      })
      .forEach((it, idx) => {
        const profitPc = (it.sell || 0) - (it.buy || 0);
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${idx + 1}</td>
          <td>${it.name}</td>
          <td>${formatMoney(it.buy)}</td>
          <td>${formatMoney(it.sell)}</td>
          <td class="badge-profit">${formatMoney(profitPc)}</td>
          <td>${it.stock ?? 0}</td>
          <td>${it.storage || ""}</td>
        `;
        tr.onclick = () => fillItemForm(it);
        tbody.appendChild(tr);
      });

    // stock tab
    const stockBody = el("stock-tbody");
    stockBody.innerHTML = "";
    let totalItems = 0;
    let inventoryCost = 0;

    items.forEach((it, idx) => {
      const stock = it.stock ?? 0;
      totalItems += stock;
      const costValue = stock * (it.buy || 0);
      const potentialProfit = stock * ((it.sell || 0) - (it.buy || 0));
      inventoryCost += costValue;

      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${idx + 1}</td>
        <td>${it.name}</td>
        <td>${stock}</td>
        <td>${formatMoney(costValue)}</td>
        <td class="badge-profit">${formatMoney(potentialProfit)}</td>
      `;
      stockBody.appendChild(tr);
    });

    el("summary-total-items").textContent = totalItems;
    el("summary-inventory-cost").textContent = formatMoney(inventoryCost);

    renderItemSelect();
    updateSummary();
  }

  function renderItemSelect() {
    const select = el("sale-item-select");
    const current = select.value;
    select.innerHTML = '<option value="">-- choose item --</option>';

    items.forEach((it) => {
      const opt = document.createElement("option");
      opt.value = String(it.id);
      opt.textContent = it.name + (it.storage ? ` [${it.storage}]` : "");
      select.appendChild(opt);
    });

    if (current) select.value = current;
  }

  function fillItemForm(it) {
    el("item-name").value = it.name;
    el("item-storage").value = it.storage || "";
    el("item-buy").value = it.buy ?? "";
    el("item-sell").value = it.sell ?? "";
    el("item-stock").value = it.stock ?? "";
    el("item-code").value = it.code || "";
  }

  function clearItemForm() {
    el("item-name").value = "";
    el("item-storage").value = "";
    el("item-buy").value = "";
    el("item-sell").value = "";
    el("item-stock").value = "";
    el("item-code").value = "";
  }

  function handleSaveItem() {
    const name = el("item-name").value.trim();
    if (!name) {
      alert("Bro, kailangan may item name.");
      return;
    }
    const storage = el("item-storage").value.trim();
    const buy = parseFloat(el("item-buy").value) || 0;
    const sell = parseFloat(el("item-sell").value) || 0;
    const stock = parseInt(el("item-stock").value || "0", 10);
    const code = el("item-code").value.trim();

    let existing = items.find(
      (it) => it.name.toLowerCase() === name.toLowerCase()
    );

    if (existing) {
      existing.storage = storage;
      existing.buy = buy;
      existing.sell = sell;
      existing.stock = stock;
      existing.code = code;
    } else {
      const newId = items.length ? Math.max(...items.map((i) => i.id)) + 1 : 1;
      items.push({
        id: newId,
        name,
        storage,
        buy,
        sell,
        stock,
        code,
      });
    }

    saveItems();
    renderItemsTable(el("search-items").value);
    alert("Na-save na ang item, bro.");
  }

  // ---- SALES ----
  function clearSaleForm() {
    el("sale-item-select").value = "";
    el("sale-qty").value = 1;
    el("sale-price").value = "";
    el("sale-total").value = "";
    el("sale-date").value = todayStr();
    el("sale-profit-info").textContent = "Profit: â‚±0";
  }

  function updateSaleTotals() {
    const itemId = parseInt(el("sale-item-select").value || "0", 10);
    const qty = parseInt(el("sale-qty").value || "0", 10);
    const price = parseFloat(el("sale-price").value || "0");
    const item = items.find((it) => it.id === itemId);
    const buy = item ? item.buy || 0 : 0;

    const total = qty * price;
    const profit = qty * (price - buy);

    el("sale-total").value = total ? total.toFixed(2) : "";
    el("sale-profit-info").textContent = "Profit: " + formatMoney(profit);
  }

  function handleSaleItemChange() {
    const itemId = parseInt(el("sale-item-select").value || "0", 10);
    const item = items.find((it) => it.id === itemId);
    if (!item) return;
    el("sale-price").value = item.sell ?? "";
    el("sale-qty").value = 1;
    updateSaleTotals();
  }

  function handleSaveSale() {
    const itemId = parseInt(el("sale-item-select").value || "0", 10);
    const item = items.find((it) => it.id === itemId);
    if (!item) {
      alert("Pili ka muna ng item, bro.");
      return;
    }

    const qty = parseInt(el("sale-qty").value || "0", 10);
    if (!qty || qty <= 0) {
      alert("Ilalagay natin ilang piraso ang nabenta.");
      return;
    }

    const price = parseFloat(el("sale-price").value || "0");
    if (!price || price <= 0) {
      alert("Kailangan may selling price.");
      return;
    }

    if ((item.stock ?? 0) < qty) {
      if (!confirm("Mas mataas ang quantity kaysa sa stock. Itutuloy pa rin?")) {
        return;
      }
    }

    const date = el("sale-date").value || todayStr();
    const total = qty * price;
    const profit = qty * (price - (item.buy || 0));

    // update stock
    item.stock = (item.stock ?? 0) - qty;
    if (item.stock < 0) item.stock = 0;
    saveItems();

    sales.push({
      id: sales.length ? sales[sales.length - 1].id + 1 : 1,
      itemId,
      itemName: item.name,
      qty,
      price,
      total,
      profit,
      date,
    });
    saveSales();

    renderItemsTable(el("search-items").value);
    renderSalesTable();
    updateSummary();

    alert("Na-save na ang sale.");
    clearSaleForm();
  }

  function renderSalesTable() {
    const tbody = el("sales-tbody");
    tbody.innerHTML = "";

    const sorted = [...sales].sort((a, b) => (a.date > b.date ? -1 : 1));

    sorted.forEach((s) => {
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${s.date}</td>
        <td>${s.itemName}</td>
        <td>${s.qty}</td>
        <td>${formatMoney(s.total)}</td>
        <td class="badge-profit">${formatMoney(s.profit)}</td>
      `;
      tbody.appendChild(tr);
    });
  }

  // ---- EXPENSES ----
  function clearExpenseForm() {
    el("exp-desc").value = "";
    el("exp-amount").value = "";
    el("exp-date").value = todayStr();
  }

  function handleSaveExpense() {
    const desc = el("exp-desc").value.trim();
    const amount = parseFloat(el("exp-amount").value || "0");
    const date = el("exp-date").value || todayStr();

    if (!desc) {
      alert("Lagyan natin ng description ang expense, bro.");
      return;
    }
    if (!amount || amount <= 0) {
      alert("Kailangan may amount ang expense.");
      return;
    }

    expenses.push({
      id: expenses.length ? expenses[expenses.length - 1].id + 1 : 1,
      desc,
      amount,
      date,
    });
    saveExpenses();
    renderExpensesTable();
    updateSummary();
    alert("Na-save na ang expense.");
    clearExpenseForm();
  }

  function renderExpensesTable() {
    const tbody = el("expenses-tbody");
    tbody.innerHTML = "";

    const sorted = [...expenses].sort((a, b) => (a.date > b.date ? -1 : 1));

    sorted.forEach((e) => {
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${e.date}</td>
        <td>${e.desc}</td>
        <td>${formatMoney(e.amount)}</td>
      `;
      tbody.appendChild(tr);
    });
  }

  // ---- SUMMARY ----
  function updateSummary() {
    const totalSales = sales.reduce((sum, s) => sum + (s.total || 0), 0);
    const totalProfit = sales.reduce((sum, s) => sum + (s.profit || 0), 0);
    const totalExpenses = expenses.reduce((sum, e) => sum + (e.amount || 0), 0);
    const net = totalProfit - totalExpenses;

    el("summary-sales").textContent = formatMoney(totalSales);
    el("summary-profit").textContent = formatMoney(totalProfit);
    el("summary-expenses").textContent = formatMoney(totalExpenses);

    const netEl = el("summary-net");
    netEl.textContent = formatMoney(net);
    netEl.classList.remove("summary-positive", "summary-negative");
    if (net > 0) netEl.classList.add("summary-positive");
    if (net < 0) netEl.classList.add("summary-negative");
  }

  // ---- RESET ALL ----
  function handleResetAll() {
    if (
      !confirm(
        "Bro, sure ka? Buburahin nito lahat ng items, sales at expenses na naka-save sa device na ito."
      )
    ) {
      return;
    }
    localStorage.removeItem(STORAGE_KEYS.ITEMS);
    localStorage.removeItem(STORAGE_KEYS.SALES);
    localStorage.removeItem(STORAGE_KEYS.EXPENSES);
    loadData();
    renderItemsTable();
    renderSalesTable();
    renderExpensesTable();
    clearItemForm();
    clearSaleForm();
    clearExpenseForm();
    alert("Na-reset na lahat ng data sa device na ito.");
  }

  // ---- TABS ----
  function initTabs() {
    const buttons = document.querySelectorAll(".tab-btn");
    buttons.forEach((btn) => {
      btn.addEventListener("click", () => {
        buttons.forEach((b) => b.classList.remove("active"));
        btn.classList.add("active");

        const tabId = btn.getAttribute("data-tab");
        document
          .querySelectorAll(".tab-content")
          .forEach((c) => (c.style.display = "none"));
        document.getElementById(tabId).style.display = "block";
      });
    });
  }

  // ---- INIT ----
  function init() {
    loadData();
    renderItemsTable();
    renderSalesTable();
    renderExpensesTable();

    el("sale-date").value = todayStr();
    el("exp-date").value = todayStr();

    // events
    el("save-item-btn").onclick = handleSaveItem;
    el("reset-item-btn").onclick = clearItemForm;

    el("sale-item-select").onchange = () => {
      handleSaleItemChange();
      updateSaleTotals();
    };
    el("sale-qty").oninput = updateSaleTotals;
    el("sale-price").oninput = updateSaleTotals;
    el("save-sale-btn").onclick = handleSaveSale;
    el("reset-sale-btn").onclick = clearSaleForm;

    el("save-exp-btn").onclick = handleSaveExpense;
    el("reset-all-btn").onclick = handleResetAll;

    el("search-items").oninput = (e) => {
      renderItemsTable(e.target.value);
    };

    initTabs();
  }

  document.addEventListener("DOMContentLoaded", init);
</script>
</body>
</html>
